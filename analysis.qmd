---
title: "A Beautiful Graphic"
format: html
author: Stephanie Hanna
execute:
  echo: false
  
---


```{r}
suppressPackageStartupMessages(library(tidyverse))
```

```{r}
# Create a beautiful scatter plot with the mpg dataset
ggplot(mpg, aes(x = displ, y = hwy)) +
  # Add points with transparency and size mapping
  geom_point(aes(color = class, size = cyl), alpha = 0.7) +
  # Add a smooth trend line
  geom_smooth(method = "loess", se = TRUE, color = "darkblue", 
              fill = "lightblue", alpha = 0.3, size = 1.2) +
  # Customize colors with a beautiful palette
  scale_color_viridis_d(name = "Vehicle Class", option = "plasma") +
  # Customize size scale
  scale_size_continuous(name = "Cylinders", range = c(2, 6),
                       breaks = c(4, 6, 8)) +
  # Improve axis labels and title
  labs(
    title = "Fuel Efficiency vs Engine Displacement",
    subtitle = "Highway MPG decreases with larger engine displacement",
    x = "Engine Displacement (liters)",
    y = "Highway Miles per Gallon",
    caption = "Data source: EPA fuel economy data from 1999-2008"
  ) +
  # Apply a clean, modern theme
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5,
                             margin = margin(b = 10)),
    plot.subtitle = element_text(size = 12, hjust = 0.5, 
                                color = "gray40", margin = margin(b = 20)),
    plot.caption = element_text(size = 9, color = "gray50"),
    legend.position = "right",
    legend.box = "vertical",
    panel.grid.minor = element_blank(),
    panel.grid.major = element_line(color = "gray95", size = 0.5),
    plot.background = element_rect(fill = "white", color = NA),
    legend.margin = margin(l = 20)
  ) +
  # Adjust axis scales for better readability
  scale_x_continuous(breaks = seq(1, 7, 1)) +
  scale_y_continuous(breaks = seq(10, 45, 5))
```
